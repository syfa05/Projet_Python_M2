import pandas as pd
import tkinter as tk
from tkinter import filedialog

def save_url_to_excel(url, output_file):
    # Lire les données à partir de l'URL
    data = pd.read_csv(url)
    
    # Enregistrer les données dans un fichier Excel
    data.to_excel(output_file, index=False)
    
    print(f"Les données ont été enregistrées dans '{output_file}'")


def import_and_save_excel_file(file_path, output_file='output.xlsx'):
    # Lire les données à partir du fichier Excel
    data = pd.read_excel(file_path)
    print(f"Les données ont été importées à partir de '{file_path}'")
    
    # Enregistrer les données dans un fichier Excel dans le projet
    data.to_excel(output_file, index=False)
    print(f"Les données ont été enregistrées dans '{output_file}'")
    
    return data


def select_file():
    root = tk.Tk()
    root.withdraw()  # Cacher la fenêtre principale
    file_path = filedialog.askopenfilename(title="Sélectionner un fichier Excel", filetypes=[("Excel files", "*.xlsx")])
    return file_path

# Demander à l'utilisateur de sélectionner un fichier
file_path = select_file()

if file_path:
    imported_data = import_and_save_excel_file(file_path)
else:
    print("Aucun fichier sélectionné")
imported_data = import_and_save_excel_file(file_path)

# URL des données
url = 'https://odre.opendatasoft.com/api/explore/v2.1/catalog/datasets/consommation-quotidienne-brute/exports/csv?lang=fr&refine=date_heure%3A%222023%22&qv1=(date_heure%3A%5B2023-12-01T23%3A00%3A00Z%20TO%202024-01-31T22%3A59%3A59Z%5D)&timezone=Europe%2FParis&use_labels=true&delimiter=%3B'

# Nom du fichier de sortie
output_file = 'output.xlsx'

# Appeler la fonction
save_url_to_excel(url, output_file)

# Lire les données à partir du fichier Excel    

